@model IEnumerable<ClaseModelo.Oferta>
@{

    ViewBag.Title = "Home Page";



    double RESULT_META_TGO_AP_PROG = (double)ViewData["RESULT_META_TGO_AP_PROG"];
    double RESULT_META_TCO_AP_PROG = (double)ViewData["RESULT_META_TCO_AP_PROG"];
    double RESULT_META_ET_AP_PROG = (double)ViewData["RESULT_META_ET_AP_PROG"];
    double RESULT_META_OTROS_AP_PROG = (double)ViewData["RESULT_META_OTROS_AP_PROG"];


    double META_GENERAL = (double)ViewData["META_GENERAL"];

    long id = (long)ViewData["idMeta"];
}

<div class="content">
    <div class="d-flex flex-column flex-md-row justify-content-md-between align-items-md-center py-2 text-center text-md-start">
        <div class="flex-grow-1 mb-1 mb-md-0">
            <h1 class="h3 fw-bold mb-2">
                Inicio
            </h1>
            <h2 class="h6 fw-medium fw-medium text-muted mb-0">
                Bienvenido <a class="fw-semibold" href="be_pages_generic_profile.html">@Session["NombreUsuario"].ToString().Split()[0]</a>, un gusto de tenerte de vuelta.
            </h2>
        </div>
    </div>
</div>
<!-- END Hero -->
<div class="content">
    <h4>Meta general vigente del año <a class="fw-semibold"><span data-toggle="year-copy"></span></a></h4>
    <div class="progress push border shadow-sm position-relative" style="height:2rem">
        <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: @META_GENERAL%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">
        </div>
        <span class="fs-4 fw-semibold position-absolute w-100 text-center">@META_GENERAL%</span>
    </div>

</div>
<!-- Page Content -->
<div class="content">
    <!-- Overview -->
    <div class="row items-push">
        <div class="col-sm-6 col-xxl-3">
            <!-- Pending Orders -->
            <div class="block block-rounded d-flex flex-column h-100 mb-0">
                <div class="block-content block-content-full flex-grow-1 d-flex justify-content-between align-items-center">
                    <dl class="mb-0">
                        <dt class="fs-3 fw-bold">@RESULT_META_TGO_AP_PROG%</dt>
                        <dd class="fs-sm fw-medium fs-sm fw-medium text-muted mb-0">Meta de Tecnológo</dd>
                    </dl>
                    <div class="item item-rounded-lg bg-body-light">
                        <i class="fa fa-2x fa-user-tie text-primary"></i>
                    </div>
                </div>
            </div>
            <!-- END Pending Orders -->
        </div>
        <div class="col-sm-6 col-xxl-3">
            <!-- New Customers -->
            <div class="block block-rounded d-flex flex-column h-100 mb-0">
                <div class="block-content block-content-full flex-grow-1 d-flex justify-content-between align-items-center">
                    <dl class="mb-0">
                        <dt class="fs-3 fw-bold">@RESULT_META_TCO_AP_PROG%</dt>
                        <dd class="fs-sm fw-medium fs-sm fw-medium text-muted mb-0">Meta de Técnico</dd>
                    </dl>
                    <div class="item item-rounded-lg bg-body-light">
                        <i class="fa fa-2x fa-user-tie text-primary" style="color: #00324D !important;"></i>
                    </div>
                </div>
            </div>
            <!-- END New Customers -->
        </div>
        <div class="col-sm-6 col-xxl-3">
            <!-- Messages -->
            <div class="block block-rounded d-flex flex-column h-100 mb-0">
                <div class="block-content block-content-full flex-grow-1 d-flex justify-content-between align-items-center">
                    <dl class="mb-0">
                        <dt class="fs-3 fw-bold">@RESULT_META_ET_AP_PROG%</dt>
                        <dd class="fs-sm fw-medium fs-sm fw-medium text-muted mb-0">Meta de Expecialista Técnico</dd>
                    </dl>
                    <div class="item item-rounded-lg bg-body-light">
                        <i class="fa fa-2x fa-user-tie text-primary" style="color: #CB7766 !important;"></i>
                    </div>
                </div>
            </div>
            <!-- END Messages -->
        </div>
        <div class="col-sm-6 col-xxl-3">
            <!-- Conversion Rate -->
            <div class="block block-rounded d-flex flex-column h-100 mb-0">
                <div class="block-content block-content-full flex-grow-1 d-flex justify-content-between align-items-center">
                    <dl class="mb-0">
                        <dt class="fs-3 fw-bold">@RESULT_META_OTROS_AP_PROG%</dt>
                        <dd class="fs-sm fw-medium fs-sm fw-medium text-muted mb-0">Meta de Otros</dd>
                    </dl>
                    <div class="item item-rounded-lg bg-body-light">
                        <i class="fa fa-2x fa-user-tie text-primary" style="color: #6A6A6A !important;"></i>
                    </div>
                </div>
            </div>
            <!-- END Conversion Rate-->
        </div>
    </div>
    <div class="bg-body-light rounded-bottom">
        <a class="block-content block-content-full block-content-sm fs-sm fw-medium d-flex align-items-center justify-content-between" href="@Url.Action("Details","Home",new {id = id })">
            <span>Detalles</span>
            <i class="fa fa-arrow-alt-circle-right ms-1 opacity-25 fs-base"></i>
        </a>
    </div>
</div>
<!-- END Page Content -->
<div class="content">
    <!-- Chart.js Charts are initialized in js/pages/be_comp_charts.min.js which was auto compiled from _js/pages/be_comp_charts.js -->
    <!-- For more info and examples you can check out http://www.chartjs.org/docs/ -->
    <h2 class="content-heading">Graficos</h2>
    <div class="row">
        <div class="col-xl-6">
            <!-- Donut Chart -->
            <div class="block block-rounded">
                <div class="block-header block-header-default">
                    <h3 class="block-title">Donal</h3>
                    <div class="block-options">
                        <button type="button" class="btn-block-option" data-toggle="block-option" data-action="state_toggle" data-action-mode="demo">
                            <i class="si si-refresh"></i>
                        </button>
                    </div>
                </div>
                <div class="block-content block-content-full text-center">
                    <div class="py-3 px-xxl-7">
                        <!-- Donut Chart Container -->
                        <canvas id="js-chartjs-donut" width="538" height="538" style="display: block; box-sizing: border-box; height: 738px; width: 738px;"></canvas>
                    </div>
                </div>
            </div>
            <!-- END Donut Chart -->
        </div>
        <div class="col-xl-6">
            <!-- Donut Chart -->
            <div class="block block-rounded">
                <div class="block-header block-header-default">
                    <h3 class="block-title">Barra</h3>
                    <div class="block-options">
                        <button type="button" class="btn-block-option" data-toggle="block-option" data-action="state_toggle" data-action-mode="demo">
                            <i class="si si-refresh"></i>
                        </button>
                    </div>
                </div>
                <div class="block-content block-content-full text-center">
                    <div class="py-3 px-xxl-7">
                        <!-- Donut Chart Container -->
                        <canvas id="js-chartjs-donut2" width="538" height="538" style="display: block; box-sizing: border-box; height: 738px; width: 738px;"></canvas>
                    </div>
                </div>
            </div>
            <!-- END Donut Chart -->
        </div>
    </div>
</div>
<div class="content">
    <div class="block block-rounded">
        <div class="block-header block-header-default">
            <h3 class="block-title">Ofertas</h3>
            <div class="block-options space-x-1">
                <button type="button" class="btn btn-sm btn-alt-secondary" data-toggle="class-toggle" data-target="#one-dashboard-search-orders" data-class="d-none">
                    <i class="fa fa-search"></i>
                </button>
                <div class="dropdown d-inline-block">
                    <button type="button" class="btn btn-sm btn-alt-secondary" id="dropdown-recent-orders-filters" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-fw fa-flask"></i>
                        Filtro
                        <i class="fa fa-angle-down ms-1"></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-md dropdown-menu-end fs-sm" aria-labelledby="dropdown-recent-orders-filters">
                        <a class="dropdown-item fw-medium d-flex align-items-center justify-content-between" href="javascript:void(0)">
                            Pendiente
                        </a>
                        <a class="dropdown-item fw-medium d-flex align-items-center justify-content-between" href="javascript:void(0)">
                            Etapa Lectiva
                        </a>
                        <a class="dropdown-item fw-medium d-flex align-items-center justify-content-between" href="javascript:void(0)">
                            Etapa Productiva
                        </a>
                        <a class="dropdown-item fw-medium d-flex align-items-center justify-content-between" href="javascript:void(0)">
                            Finalizadas
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div id="one-dashboard-search-orders" class="block-content border-bottom d-none">
            <!-- Search Form -->
            <form action="be_pages_dashboard.html" method="POST" onsubmit="return false;">
                <div class="push">
                    <div class="input-group">
                        <input type="text" class="form-control form-control-alt" id="one-ecom-orders-search" name="one-ecom-orders-search" placeholder="Buscar Oferta..">
                        <span class="input-group-text bg-body border-0">
                            <i class="fa fa-search"></i>
                        </span>
                    </div>
                </div>
            </form>
            <!-- END Search Form -->
        </div>
        <div class="block-content block-content-full">
            <!-- Recent Orders Table -->
            <div class="table-responsive">
                <table class="table table-hover table-striped table-vcenter js-dataTable-resposive">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th class="d-none d-xl-table-cell">Fecha inicio</th>
                            <th class="d-none d-sm-table-cell text-end"># Fichas</th>
                            <th style="width: 15%;">Acciones</th>
                        </tr>
                    </thead>
                    <tbody class="fs-sm">
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td>
                                    @item.NombreOferta
                                </td>
                                <td class="d-none d-xl-table-cell">
                                    @(DateTime.Parse(item.FechaInicioOferta).ToString("dd/MM/yyyy"))
                                </td>
                                <td class="d-none d-sm-table-cell text-end">
                                    <strong>@item.Ficha.Count()</strong>
                                </td>
                                <td>
                                    <a href="/Fichas/Oferta_Fichas/@item.IdOferta">Fichas</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <!-- END Recent Orders Table -->
        </div>
        <div class="block-content block-content-full bg-body-light">
            <!-- Pagination -->
            <nav aria-label="Photos Search Navigation">
                <ul class="pagination pagination-sm justify-content-end mb-0">
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0)" tabindex="-1" aria-label="Previous">
                            Prev
                        </a>
                    </li>
                    <li class="page-item active">
                        <a class="page-link" href="javascript:void(0)">1</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0)">2</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0)">3</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0)">4</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0)" aria-label="Next">
                            Next
                        </a>
                    </li>
                </ul>
            </nav>
            <!-- END Pagination -->
        </div>
    </div>
    <!-- END Recent Orders -->
</div>


<script>
        window.addEventListener('load', function () {
            // Código a ejecutar cuando se cargan todos los scripts
            Data = {
                labels: ["META TGO", "META TCO", "META ET", "META OTROS"],
                datasets: [
                    {
                        data: [@RESULT_META_TGO_AP_PROG,@RESULT_META_TCO_AP_PROG,@RESULT_META_ET_AP_PROG,@RESULT_META_OTROS_AP_PROG],
                        backgroundColor: [
                            "rgb(57, 169, 0,1)",
                            "rgb(0, 50, 77,1)",
                            "rgb(203, 119, 102,1)",
                            "rgb(106, 106, 106,1)",
                        ],
                        hoverBackgroundColor: [
                            "rgb(57, 169, 0,.75)",
                            "rgb(0, 50, 77,.75)",
                            "rgb(203, 119, 102,.75)",
                            "rgb(106, 106, 106,.75)",
                        ],
                    },
                ],
            };
            loadChartsOnHome();

            fetch("/Programa_Formacion", {
                method: "get",
                headers: {
                    "Content-Type": "application/json",
                    "Accept": 'application/json',
                }
            }).then(res => {
                console.log(res)
            })

        });

</script>

